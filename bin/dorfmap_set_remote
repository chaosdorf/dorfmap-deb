#!/bin/sh

case "${1}" in
feedback1)

cd /tmp/feedback1
( cat 1 2 3 4 5 6 7 8 9 10 11 12 13; echo "0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0" ) | si2c-bitwrite 21 20

;;
feedback2)

cd /tmp/feedback2
( echo $(( ( $(cat bin1) << 1 ) | ( $( cat bin3) << 3 ) | ( $(cat bin5) << 5 ) | ( $(cat bin6) << 6 ) ));
cat pwm0 pwm1 pwm2; echo "0\n6" ) | si2c-bytewrite 21 20
;;

feedback3)
cd /tmp/feedback3
( cat 1 2 3 4 5 6 7 8 9 10 11 12; echo "0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n1\n1" ) | si2c-bitwrite 21 20

;;
feedback5)

cd /tmp/feedback5
( cat 1 2 3 4 5 6 7 8; echo "0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n1" ) | si2c-bitwrite 21 20

;;
feedback6)

cd /tmp/feedback6
( echo $(( ( $(cat bin0) ) | ( $(cat bin1) << 1 ) | ( $( cat bin3) << 3 ) | ( $(cat bin5) << 5 ) | ( $(cat bin6) << 6 ) | ( $(cat bin7) << 7 ) ));
cat pwm0 pwm1 pwm2; echo "0\n10" ) | si2c-bytewrite 21 20

;;
feedback7)

cd /tmp/feedback7
( echo $(( ( $(cat bin0) ) | ( $(cat bin1) << 1 ) | ( $(cat bin2) << 5 ) | ( $(cat bin3) << 6 ) | ( $(cat bin4) << 7 ) ));
echo $(( ( $(cat bin5) ) | ( $(cat bin6) << 1 ) | ( $(cat bin7) << 4 ) | ( $(cat bin8) << 6 ) ));
cat pwm0 pwm1 pwm2 pwm3; echo "0\n12" ) | si2c-bytewrite 21 20

;;
feedback8)

cd /tmp/feedback8
( echo $(( ( $(cat bin0) ) | ( $(cat bin1) << 1 ) | ( $(cat bin2) << 5 ) | ( $(cat bin3) << 6 ) | ( $(cat bin4) << 7 ) ));
echo $(( ( $(cat bin5) ) | ( $(cat bin6) << 1 ) | ( $(cat bin7) << 4 ) | ( $(cat bin8) << 6 ) ));
cat pwm0 pwm1 pwm2 pwm3; echo "0\n13" ) | si2c-bytewrite 21 20

;;
feedback9)

cd /tmp/feedback9
( echo $(( ( $(cat bin0) ) | ( $(cat bin1) << 1 ) | ( $(cat bin2) << 5 ) | ( $(cat bin3) << 6 ) | ( $(cat bin4) << 7 ) ));
echo $(( ( $(cat bin5) ) | ( $(cat bin6) << 1 ) | ( $(cat bin7) << 4 ) | ( $(cat bin8) << 6 ) ));
cat pwm0 pwm1 pwm2 pwm3; echo "0\n14" ) | si2c-bytewrite 21 20

;;
feedback10)

cd /tmp/feedback10
( echo $(( ( $(cat bin0) ) | ( $(cat bin1) << 1 ) | ( $(cat bin2) << 5 ) | ( $(cat bin3) << 6 ) | ( $(cat bin4) << 7 ) ));
echo $(( ( $(cat bin5) << 4 ) | ( $(cat bin6) << 6 ) ));
cat pwm0 pwm1 pwm2 pwm3; echo "0\n15" ) | si2c-bytewrite 21 20

;;
donationprint1)

cd /tmp/donationprint1
(echo "$(cat /etc/dorfmap/pw.avrshift)"; cat 1 2 3 4 5 6 7 8 9 10 11 12 13; echo "0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0" ) | nc -w 4 donationprint 1337

;;
helios1)

cd /tmp/helios1
if [ "$(cat "$2")" = 1 ]; then
	echo "$(cat /etc/dorfmap/pw.powerswitch)" on "$2" | nc -w 4 helios 1338
else
	echo "$(cat /etc/dorfmap/pw.powerswitch)" off "$2" | nc -w 4 helios 1338
fi

;;

*)

echo "unable to handle arguments '$@' on $(date)" >> /tmp/dorfmap-err/dorfmap_set_remote
env >> /tmp/dorfmap-err/dorfmap_set_remote
echo "" >> /tmp/dorfmap-err/dorfmap_set_remote

;;
esac
